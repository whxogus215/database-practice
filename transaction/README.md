# 🚀 프로젝트: "공안 대마 특이 4과 임무 관리 시스템"
## 프로젝트 개요
당신은 '마키마'의 지시를 받아, 데블 헌터들의 임무 수행 실적을 관리하는 백엔드 시스템을 개발합니다.  
헌터들이 토벌한 악마에서 수집한 **총의 악마 살점을 집계**하고, 그들의 공안 내 등급을 관리하며,  
특정 구역에 출몰한 악마를 리포트하는 과정에서 발생하는 **데이터 동시성 문제를 오직 트랜잭션 격리 수준만으로 제어**해 봅니다.

## 주요 학습 목표
- **Dirty Read 경험**: 한 트랜잭션이 아직 커밋되지 않은 데이터를 다른 트랜잭션이 읽을 때 발생하는 문제를 경험합니다.
- **Non-Repeatable Read 경험**: 한 트랜잭션 내에서 같은 데이터를 두 번 읽었을 때 다른 결과가 나오는 현상을 경험합니다.
- **Phantom Read 경험**: 한 트랜잭션 내에서 같은 범위로 쿼리를 두 번 실행했을 때, 없던 데이터가 나타나는 현상을 경험합니다.
- **격리 수준의 효과 체감**: `READ_UNCOMMITTED`부터 `SERIALIZABLE`까지 스프링 `@Transactional(isolation = ...)` 설정을 변경하며 각 문제가 어떻게 해결되거나 다르게 동작하는지 코드로 직접 확인합니다.

---
## Mission 1: '덴지와 파워'의 임무 정산 중 발생하는 Dirty Read

### 상황
'덴지'와 '파워'가 한 팀이 되어 악마 토벌 임무를 마쳤습니다. 이제 본부에서 임무 결과를 정산하는 트랜잭션이 시작됩니다.
- 하나의 트랜잭션 = '임무 번호 123 정산'
  1. **(데이터 증가)**: '덴지'가 수집한 악마의 살점 5개를 총량에 더합니다. (아직 커밋 전)
  2. **(데이터 감소)**: '파워'가 임무 중 분실한 살점 2개에 대한 책임을 물어 총량에서 차감합니다. (아직 커밋 전)
- 동시 접근 발생
  1. 위의 정산 트랜잭션(1번과 2번)이 모두 끝나고 **커밋(Commit)되기 전**, 별개의 트랜잭션('마키마의 실시간 현황판')이 현재까지 수집된 살점의 총합을 조회합니다.

### 요구사항
1. `DevilFlesh` 엔티티 생성
   - `id`, `totalPieces` (수집된 살점 총량)
2. `MissionReportService` 구현
   - 하나의 메서드(`settleMission`) 안에서 `totalPieces`를 증가시키고, 또 감소시키는 로직을 구현합니다.
   - 이 메서드 전체가 하나의 트랜잭션으로 묶여야 합니다.
3. 테스트 코드 작성
   - `settleMission` 메서드가 실행되는 도중(커밋 전), 별도의 스레드가 살점 총량을 조회하도록 하여 **Dirty Read**를 재현합니다.
   - `@Transactional(isolation = Isolation.READ_UNCOMMITTED)`를 사용하여 현상을 관찰합니다.

### 고민해 볼 점
- 만약 정산 트랜잭션이 중간에 롤백(Rollback)된다면, 마키마의 현황판이 읽어간 데이터는 어떻게 될까요? 이것이 왜 치명적인 문제일까요?
